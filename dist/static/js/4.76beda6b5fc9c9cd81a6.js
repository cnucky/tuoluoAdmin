webpackJsonp([4],{"3bti":function(e,t,a){"use strict";var i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},e._l(e.data,function(e){return a("el-tab-pane",{key:e.value,attrs:{label:e.name,name:e.value}})}))],1)},staticRenderFns:[]},l=a("VU/8")({data:function(){return{activeName:0,data:[{name:"APP国际",value:"0"},{name:"APP国内",value:"1"},{name:"PC客户端",value:"2"}]}},mounted:function(){this.$emit("activeIndex",this.activeName)},methods:{handleClick:function(e,t){this.$emit("activeIndex",this.activeName)}}},i,!1,null,null,null);t.a=l.exports},"5Zxq":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("3bti"),l=a("P9l9"),s={components:{navHead:i.a},data:function(){return{activeIndex:0,tableData:[],dialogFormVisible:!1,form:{name:"",image_url:"",type:""},uploadUrl:"/api/admin/upload/",imageUrl:"",loading:!0,rule:{name:[{required:!0,message:"请输入名称",trigger:"blur"}],image_url:[{required:!0,message:"请上传图标",trigger:"blur"}]},pageSizes:[20],pageSize:20,total:0,currentPage:1,opeType:"",id:"",modalTitle:"添加游戏"}},mixins:[{computed:{headerRowStyle:function(){return{backgroundColor:"#F5F7FA"}}}}],watch:{activeIndex:function(e,t){e!=t&&(this.loading=!0,this.form.name="",this.form.image_url="",this.imageUrl="")}},methods:{getActiveIndex:function(e){this.activeIndex=e,0==e?this.form.type=2:1==e?this.form.type=1:2==e&&(this.form.type=3),this.getGamesListData()},handleClick:function(e){},handleEdit:function(e){this.dialogFormVisible=!0,this.form.name=e.name,this.form.image_url=e.image_url,this.imageUrl=e.image_url,this.opeType="update",this.id=e.id,this.modalTitle="修改游戏"},handleDel:function(e){var t=this,a={id:e.id};Object(l.g)(a).then(function(e){t.$message.success("删除成功"),t.getGamesListData()}).catch(function(e){console.log(e)})},addNewGame:function(){this.dialogFormVisible=!0,this.form.name="",this.form.image_url="",this.imageUrl="",this.opeType="add",this.modalTitle="添加游戏"},handleAvatarSuccess:function(e,t){this.imageUrl=URL.createObjectURL(t.raw),this.form.image_url=e.url},beforeAvatarUpload:function(e){console.log(e);var t=!1,a=e.type;"image/jpeg"!==a&&"image/png"!==a&&"image/jpg"!==a||(t=!0);var i=e.size/1024/1024<2;return t||this.$message.error("上传图标只能是 JPG/PNG 格式!"),i||this.$message.error("上传图标大小不能超过 2MB!"),t&&i},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;var a=t.form;if(console.log(t.opeType),"add"==t.opeType)Object(l.b)(a).then(function(e){e&&"ok"==e.status?(t.$message.success("添加成功"),t.getGamesListData()):t.$message.success("添加失败"),t.dialogFormVisible=!1}).catch(function(e){console.log(e)});else if("update"==t.opeType){var i={id:t.id};Object(l.s)(i,a).then(function(e){e&&"ok"==e.status?(t.$message.success("修改成功"),t.getGamesListData()):t.$message.success("修改失败"),t.dialogFormVisible=!1}).catch(function(e){console.log(e)})}})},getGamesListData:function(){var e=this,t={type:this.form.type,page:this.currentPage,page_size:this.pageSize};Object(l.j)(t).then(function(t){t&&t.results?(e.tableData=t.results,e.total=t.count,e.loading=!1):e.tableData=[]}).catch(function(e){console.log("err",e)})},handleSizeChange:function(e){console.log("每页 "+e+" 条")},handleCurrentChange:function(e){console.log("当前页: "+e),this.currentPage=e,this.getGamesListData()}}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"games_manage"},[a("nav-head",{on:{activeIndex:e.getActiveIndex}}),e._v(" "),a("div",[a("div",{staticClass:"operate_btns"},[a("el-button",{attrs:{type:"primary"}},[e._v("导出")]),e._v(" "),a("el-button",{attrs:{type:"success"},on:{click:e.addNewGame}},[e._v("添加游戏")])],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"","header-cell-style":e.headerRowStyle}},[a("el-table-column",{attrs:{prop:"id",label:"ID",width:"80px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"名称"}}),e._v(" "),a("el-table-column",{attrs:{label:"图标"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("img",{attrs:{src:e.row.image_url,width:"100px",alt:""}})]}}])}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.handleEdit(t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.handleDel(t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("div",{staticClass:"page_block"},[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":e.pageSizes,"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.modalTitle,visible:e.dialogFormVisible,width:"40%"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"100px",rules:e.rule}},[a("el-form-item",{attrs:{label:"游戏名称",prop:"name"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"游戏图标",prop:"image_url"}},[a("el-input",{staticClass:"icon_url",attrs:{"auto-complete":"off"},model:{value:e.form.image_url,callback:function(t){e.$set(e.form,"image_url",t)},expression:"form.image_url"}}),e._v(" "),a("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.uploadUrl,"show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.imageUrl?a("img",{staticClass:"avatar",attrs:{src:e.imageUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e._v(" "),a("el-form-item",{staticClass:"modal_btns"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("form")}}},[e._v("确 定")])],1)],1)],1)],1)},staticRenderFns:[]};var o=a("VU/8")(s,n,!1,function(e){a("pWKN")},"data-v-7a4b4216",null);t.default=o.exports},pWKN:function(e,t){}});
//# sourceMappingURL=4.76beda6b5fc9c9cd81a6.js.map